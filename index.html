<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Simulaci√≥n de e-commerce para laboratorio: cat√°logo, colecciones, FAQ y contacto." />
  <title>Silpro 3R ‚Äî Simulaci√≥n (Laboratorio)</title>

  <style>
    :root{
      --bg:#0b1220;
      --panel:#0f1b33;
      --panel2:#101f3d;
      --text:#e9eefc;
      --muted:#b9c6ee;
      --line:rgba(255,255,255,.10);
      --brand:#5aa2ff;
      --brand2:#7cffa6;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --max: 1120px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:var(--font);
      color:var(--text);
      background:
        radial-gradient(900px 600px at 20% 10%, rgba(90,162,255,.20), transparent 60%),
        radial-gradient(700px 500px at 80% 0%, rgba(124,255,166,.10), transparent 55%),
        radial-gradient(800px 700px at 50% 100%, rgba(90,162,255,.10), transparent 60%),
        var(--bg);
      line-height:1.45;
    }

    a{ color:inherit; text-decoration:none; }
    button,input,select,textarea{ font:inherit; color:inherit; }

    .wrap{ width:min(var(--max), calc(100% - 32px)); margin:0 auto; }

    /* Top bar */
    .topbar{
      background:rgba(0,0,0,.20);
      border-bottom:1px solid var(--line);
      backdrop-filter: blur(10px);
    }
    .topbar .row{
      display:flex; gap:14px; align-items:center; justify-content:space-between;
      padding:10px 0;
      font-size:13px;
      color:var(--muted);
    }
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:6px 10px; border:1px solid var(--line); border-radius:999px;
      background:rgba(255,255,255,.04);
    }

    /* Header */
    header{
      position:sticky; top:0; z-index:50;
      background:rgba(11,18,32,.55);
      border-bottom:1px solid var(--line);
      backdrop-filter: blur(12px);
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 0;
      gap:16px;
    }
    .brand{
      display:flex; align-items:center; gap:12px; min-width:220px;
    }
    .logo{
      width:42px; height:42px; border-radius:14px;
      background:
        linear-gradient(135deg, rgba(90,162,255,.95), rgba(124,255,166,.55));
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .logo::after{
      content:"";
      position:absolute; inset:-30%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.50), transparent 45%);
      transform: rotate(18deg);
    }
    .brand strong{ font-size:15px; letter-spacing:.2px; }
    .brand small{ display:block; color:var(--muted); font-size:12px; margin-top:2px; }

    .links{ display:flex; gap:12px; flex-wrap:wrap; justify-content:center; }
    .link{
      padding:8px 10px; border-radius:12px;
      color:var(--muted);
    }
    .link:hover{ background:rgba(255,255,255,.06); color:var(--text); }

    .actions{
      display:flex; gap:10px; align-items:center; justify-content:flex-end; min-width:260px;
    }
    .search{
      display:flex; align-items:center; gap:10px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:999px;
      padding:10px 12px;
      width:min(360px, 42vw);
    }
    .search input{
      background:transparent; border:0; outline:0;
      width:100%;
      color:var(--text);
    }
    .btn{
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      border-radius:999px;
      padding:10px 12px;
      cursor:pointer;
    }
    .btn.primary{
      border-color: rgba(90,162,255,.55);
      background: linear-gradient(135deg, rgba(90,162,255,.25), rgba(124,255,166,.12));
    }
    .btn:hover{ filter:brightness(1.06); }

    /* Hero */
    .hero{ padding:34px 0 8px; }
    .heroGrid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:18px;
      align-items:stretch;
    }
    .card{
      background: linear-gradient(180deg, rgba(15,27,51,.85), rgba(15,27,51,.55));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .heroMain{ padding:22px; }
    .kicker{
      display:inline-flex; gap:10px; align-items:center;
      color:var(--muted);
      font-size:13px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      padding:8px 10px; border-radius:999px;
    }
    h1{
      margin:14px 0 10px;
      font-size: clamp(26px, 3.4vw, 44px);
      letter-spacing:-.6px;
      line-height:1.05;
    }
    .lead{ color:var(--muted); font-size:15px; margin:0 0 16px; max-width:58ch; }
    .ctaRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    .stats{
      display:grid; grid-template-columns: repeat(3, 1fr);
      gap:10px; margin-top:16px;
    }
    .stat{
      padding:12px;
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(255,255,255,.04);
    }
    .stat b{ display:block; font-size:16px; }
    .stat span{ color:var(--muted); font-size:12px; }

    .heroSide{
      padding:18px;
      display:flex; flex-direction:column; gap:12px;
      background: linear-gradient(180deg, rgba(16,31,61,.90), rgba(16,31,61,.55));
    }
    .sideBlock{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:16px;
      padding:14px;
    }
    .sideBlock h3{ margin:0 0 8px; font-size:14px; }
    .sideBlock p{ margin:0; color:var(--muted); font-size:13px; }
    .sideMeta{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .chip{
      font-size:12px; color:var(--muted);
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:6px 10px; border-radius:999px;
    }

    /* Sections */
    section{ padding:18px 0; }
    .sectionHead{
      display:flex; align-items:flex-end; justify-content:space-between; gap:14px;
      margin:8px 0 12px;
    }
    .sectionHead h2{
      margin:0;
      font-size:18px;
      letter-spacing:-.2px;
    }
    .sectionHead p{ margin:0; color:var(--muted); font-size:13px; max-width:70ch; }

    .grid3{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
    }
    .grid4{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:12px;
    }

    .tile{
      padding:14px;
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(255,255,255,.04);
      transition: transform .15s ease, filter .15s ease;
    }
    .tile:hover{ transform: translateY(-2px); filter:brightness(1.05); }
    .tile h3{ margin:0 0 8px; font-size:14px; }
    .tile p{ margin:0; color:var(--muted); font-size:13px; }
    .tile .meta{ margin-top:10px; display:flex; gap:10px; flex-wrap:wrap; }
    .badge{
      font-size:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      padding:6px 10px;
      border-radius:999px;
    }

    /* Product grid */
    .toolbar{
      display:flex; gap:10px; flex-wrap:wrap;
      align-items:center; justify-content:space-between;
      padding:12px;
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(255,255,255,.03);
    }
    .toolbar .left, .toolbar .right{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    select{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:12px;
      padding:10px 12px;
      outline:0;
    }

    .products{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:12px;
    }
    .product{
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(255,255,255,.04);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 240px;
    }
    .thumb{
      height:120px;
      background:
        radial-gradient(240px 120px at 30% 30%, rgba(90,162,255,.35), transparent 60%),
        radial-gradient(240px 120px at 80% 20%, rgba(124,255,166,.18), transparent 55%),
        rgba(255,255,255,.03);
      border-bottom:1px solid var(--line);
      position:relative;
    }
    .thumb .tag{
      position:absolute; top:10px; left:10px;
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.18);
      color:var(--muted);
    }
    .pBody{ padding:12px; display:flex; flex-direction:column; gap:8px; flex:1; }
    .pTitle{ font-size:13.5px; margin:0; }
    .pDesc{ margin:0; color:var(--muted); font-size:12.5px; }
    .pRow{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-top:auto; }
    .price{ font-weight:700; font-size:13px; }
    .mini{ font-size:12px; color:var(--muted); }

    /* FAQ + contact */
    details{
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(255,255,255,.03);
      padding:12px 14px;
    }
    details + details{ margin-top:10px; }
    summary{ cursor:pointer; font-weight:600; }
    details p{ margin:10px 0 0; color:var(--muted); font-size:13px; }

    .form{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    .form .full{ grid-column:1 / -1; }
    .field{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:14px;
      padding:10px 12px;
      outline:0;
      width:100%;
    }
    textarea.field{ min-height:110px; resize:vertical; }

    footer{
      margin-top:18px;
      border-top:1px solid var(--line);
      background:rgba(0,0,0,.18);
    }
    .foot{
      padding:18px 0;
      display:grid;
      grid-template-columns: 1.2fr .8fr 1fr;
      gap:14px;
      color:var(--muted);
      font-size:13px;
    }
    .foot h4{ margin:0 0 10px; color:var(--text); font-size:13.5px; }
    .foot a{ color:var(--muted); }
    .foot a:hover{ color:var(--text); }
    .copy{
      border-top:1px solid var(--line);
      padding:12px 0;
      color:var(--muted);
      font-size:12px;
    }

    /* ===== Modal Chat soporte ===== */
    .modal{ position:fixed; inset:0; display:none; z-index:9999; }
    .modal.is-open{ display:block; }
    .modal__backdrop{
      position:absolute; inset:0;
      background:rgba(0,0,0,.55);
      backdrop-filter: blur(6px);
    }
    .modal__panel{
      position:relative;
      width:min(720px, calc(100% - 24px));
      margin: 6vh auto;
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      background: linear-gradient(180deg, rgba(15,27,51,.95), rgba(15,27,51,.70));
      overflow:hidden;
    }
    .modal__head{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
      padding:14px 14px;
      border-bottom:1px solid var(--line);
    }
    .modal__sub{ font-size:12px; color:var(--muted); margin-top:3px; }

    /* Chat bubbles */
    .chatlog{
      height: 360px;
      overflow:auto;
      padding:14px;
      background: rgba(0,0,0,.10);
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .msg{
      max-width: 78%;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(255,255,255,.04);
      white-space:pre-wrap;
      word-break:break-word;
    }
    .msg.me{
      margin-left:auto;
      background: linear-gradient(135deg, rgba(90,162,255,.18), rgba(124,255,166,.10));
      border-color: rgba(90,162,255,.35);
    }
    .msg.bot{
      margin-right:auto;
    }
    .msg .meta{
      display:block;
      font-size:11px;
      color:var(--muted);
      margin-top:6px;
    }

    .chatbar{
      display:flex; gap:10px; align-items:center;
      padding:12px 14px;
      border-top:1px solid var(--line);
      background: rgba(255,255,255,.02);
    }

    /* Responsive */
    @media (max-width: 980px){
      .heroGrid{ grid-template-columns: 1fr; }
      .actions{ min-width:unset; }
      .grid4{ grid-template-columns: repeat(2, 1fr); }
      .products{ grid-template-columns: repeat(2, 1fr); }
      .foot{ grid-template-columns: 1fr; }
    }
    @media (max-width: 560px){
      .links{ display:none; }
      .search{ width: 56vw; }
      .grid3{ grid-template-columns: 1fr; }
      .grid4{ grid-template-columns: 1fr; }
      .products{ grid-template-columns: 1fr; }
      .form{ grid-template-columns: 1fr; }
      .modal__panel{ margin: 3vh auto; }
      .chatlog{ height: 55vh; }
      .msg{ max-width: 92%; }
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="wrap">
      <div class="row">
        <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
          <span class="pill">Simulaci√≥n para laboratorio</span>
          <span class="pill">Entrega local ‚Ä¢ Env√≠os ‚Ä¢ Atenci√≥n WhatsApp</span>
        </div>
        <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;">
          <span class="pill">Horario: Lun‚ÄìVie 08:30‚Äì17:30 ‚Ä¢ S√°b 08:30‚Äì12:30</span>
        </div>
      </div>
    </div>
  </div>

  <header>
    <div class="wrap">
      <div class="nav">
        <a class="brand" href="#inicio" aria-label="Ir al inicio">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <strong>SILPRO 3R</strong>
            <small>Simulaci√≥n e-commerce (laboratorio)</small>
          </div>
        </a>

        <nav class="links" aria-label="Navegaci√≥n principal">
          <a class="link" href="#inicio">Inicio</a>
          <a class="link" href="#colecciones">Colecciones</a>
          <a class="link" href="#productos">Productos</a>
          <a class="link" href="#faq">Preguntas frecuentes</a>
          <a class="link" href="#contacto">Contacto</a>
        </nav>

        <div class="actions">
          <div class="search" role="search">
            <span aria-hidden="true">üîé</span>
            <input id="q" type="search" placeholder="Buscar producto (laboratorio)..." autocomplete="off" />
          </div>
          <button class="btn" id="btnCart" type="button" title="Carrito (simulado)">üõí</button>

          <!-- BOT√ìN SOPORTE -->
          <button class="btn" id="btnSupport" type="button" title="Atenci√≥n al cliente">üí¨ Atenci√≥n al cliente</button>

          <a class="btn primary" href="#productos">Ver cat√°logo</a>
        </div>
      </div>
    </div>
  </header>

  <main id="inicio" class="wrap">
    <div class="hero">
      <div class="heroGrid">
        <div class="card heroMain">
          <span class="kicker">Empresa de suministros ‚Ä¢ Limpieza ‚Ä¢ Higiene ‚Ä¢ Consumibles</span>
          <h1>Cat√°logo y servicios para limpieza, imagen e higiene (simulaci√≥n para clase)</h1>
          <p class="lead">
            Esta p√°gina est√° pensada para practicar un e-commerce completo: colecciones, b√∫squeda, fichas de producto, FAQ y contacto.
            El contenido es demostrativo para tu laboratorio; reemplaza textos, logos e im√°genes seg√∫n tu caso.
          </p>

          <div class="ctaRow">
            <a class="btn primary" href="#colecciones">Explorar colecciones</a>
            <a class="btn" href="#contacto">Solicitar cotizaci√≥n</a>
            <a class="btn" href="#faq">Ver FAQ</a>
          </div>

          <div class="stats" aria-label="Indicadores">
            <div class="stat">
              <b>+14 a√±os</b>
              <span>Experiencia (texto demo)</span>
            </div>
            <div class="stat">
              <b>Marcas l√≠deres</b>
              <span>Calidad y certificaciones (demo)</span>
            </div>
            <div class="stat">
              <b>M√©rida y Canc√∫n</b>
              <span>Cobertura regional (demo)</span>
            </div>
          </div>
        </div>

        <aside class="card heroSide" aria-label="Bloques laterales">
          <div class="sideBlock">
            <h3>Nuestras marcas (demo)</h3>
            <p>Bloque tipo ‚Äúmarcas‚Äù habitual en Shopify. Sustituye por logos reales o tarjetas.</p>
            <div class="sideMeta">
              <span class="chip">Tork</span>
              <span class="chip">Rubbermaid</span>
              <span class="chip">Wiese</span>
              <span class="chip">GCPaper</span>
            </div>
          </div>

          <div class="sideBlock">
            <h3>Vis√≠tanos (demo)</h3>
            <p>
              Calle 23 Num 81B Int 2, Cholul, 97300, Yucat√°n<br/>
              Tel/WhatsApp: 999 121 4058
            </p>
            <div class="sideMeta">
              <span class="chip">Entrega local 24h (demo)</span>
              <span class="chip">Recolecci√≥n en oficina</span>
            </div>
          </div>

          <div class="sideBlock">
            <h3>Objetivo did√°ctico</h3>
            <p>Simular navegaci√≥n, filtrado, sort, cards y captura de leads para automatizaci√≥n (n8n/Sheets/CRM).</p>
          </div>
        </aside>
      </div>
    </div>

    <section id="colecciones">
      <div class="sectionHead">
        <div>
          <h2>Colecciones</h2>
          <p>Representa las categor√≠as t√≠picas de cat√°logo (papel, qu√≠micos, jarcier√≠a, autos, etc.).</p>
        </div>
      </div>

      <div class="grid4">
        <a class="tile" href="#productos" data-collection="Papel">
          <h3>Papel</h3>
          <p>Toallas, higi√©nicos, servilletas, wipers.</p>
          <div class="meta"><span class="badge">Colecci√≥n</span><span class="badge">Alta rotaci√≥n</span></div>
        </a>
        <a class="tile" href="#productos" data-collection="Limpieza">
          <h3>Limpieza</h3>
          <p>Desinfectantes, limpiadores, cloro, detergentes.</p>
          <div class="meta"><span class="badge">Colecci√≥n</span><span class="badge">Profesional</span></div>
        </a>
        <a class="tile" href="#productos" data-collection="Aromatizantes">
          <h3>Aromatizantes</h3>
          <p>Aerosoles, ambientadores y control de olores.</p>
          <div class="meta"><span class="badge">Colecci√≥n</span><span class="badge">Aerosol</span></div>
        </a>
        <a class="tile" href="#productos" data-collection="Jarcier√≠a">
          <h3>Jarcier√≠a</h3>
          <p>Trapeadores, mopas, jaladores, fibras, pa√±os.</p>
          <div class="meta"><span class="badge">Colecci√≥n</span><span class="badge">Operaci√≥n</span></div>
        </a>
      </div>
    </section>

    <section id="productos">
      <div class="sectionHead">
        <div>
          <h2>Productos (demo)</h2>
          <p>Grid de productos con ‚Äútag‚Äù, precio y bot√≥n de acci√≥n. B√∫squeda y filtros funcionan en cliente.</p>
        </div>
      </div>

      <div class="toolbar" aria-label="Barra de filtros">
        <div class="left">
          <span class="mini">Filtrar:</span>
          <select id="filterCollection" aria-label="Filtrar por colecci√≥n">
            <option value="all">Todas</option>
            <option value="Papel">Papel</option>
            <option value="Limpieza">Limpieza</option>
            <option value="Aromatizantes">Aromatizantes</option>
            <option value="Jarcier√≠a">Jarcier√≠a</option>
            <option value="Autos">Autos</option>
          </select>

          <select id="filterStock" aria-label="Filtrar por disponibilidad">
            <option value="all">Todas</option>
            <option value="in">En stock</option>
            <option value="out">Agotado</option>
          </select>
        </div>

        <div class="right">
          <span class="mini">Ordenar:</span>
          <select id="sortBy" aria-label="Ordenar productos">
            <option value="popular">M√°s vendidos (demo)</option>
            <option value="az">A‚ÄìZ</option>
            <option value="za">Z‚ÄìA</option>
            <option value="priceAsc">Precio ‚Üë</option>
            <option value="priceDesc">Precio ‚Üì</option>
          </select>
          <button class="btn" id="btnReset" type="button">Reset</button>
        </div>
      </div>

      <div class="products" id="products" aria-label="Listado de productos"></div>
    </section>

    <section id="faq">
      <div class="sectionHead">
        <div>
          <h2>Preguntas frecuentes</h2>
          <p>Secci√≥n tipo Shopify ‚ÄúFAQ‚Äù. Textos demostrativos.</p>
        </div>
      </div>

      <details>
        <summary>¬øQui√©nes somos?</summary>
        <p>Simulaci√≥n de empresa de suministros y consumibles para higiene/limpieza. Sustituye por tu descripci√≥n real.</p>
      </details>

      <details>
        <summary>¬øC√≥mo funcionan los pedidos?</summary>
        <p>Ejemplo: compra en l√≠nea, recolecci√≥n en oficina o entrega local. Define tus SLA, horarios y cobertura.</p>
      </details>

      <details>
        <summary>¬øC√≥mo puedo contactarlos?</summary>
        <p>Usa el formulario de contacto o WhatsApp. En el laboratorio esto conecta con n8n / Sheets / CRM.</p>
      </details>
    </section>

    <section id="contacto">
      <div class="sectionHead">
        <div>
          <h2>Contacto</h2>
          <p>Formulario simple para capturar leads. En clase lo puedes conectar a n8n Forms o un webhook.</p>
        </div>
      </div>

      <div class="card" style="padding:16px;">
        <form id="contactForm">
          <div class="form">
            <input class="field" name="nombre" placeholder="Nombre" required />
            <input class="field" name="email" type="email" placeholder="Correo electr√≥nico" required />
            <input class="field" name="telefono" placeholder="N√∫mero de tel√©fono" />
            <input class="field" name="empresa" placeholder="Empresa (opcional)" />
            <textarea class="field full" name="mensaje" placeholder="Mensaje" required></textarea>
          </div>
          <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:12px;">
            <button class="btn primary" type="submit">Enviar</button>
            <span class="mini" id="formStatus" role="status" aria-live="polite"></span>
          </div>
        </form>
      </div>
    </section>
  </main>

  <footer>
    <div class="wrap">
      <div class="foot">
        <div>
          <h4>SILPRO 3R ‚Äî Simulaci√≥n</h4>
          <div>Laboratorio did√°ctico para pr√°cticas de e-commerce, anal√≠tica y automatizaci√≥n.</div>
        </div>
        <div>
          <h4>Men√∫ r√°pido</h4>
          <div style="display:grid; gap:8px;">
            <a href="#inicio">Inicio</a>
            <a href="#colecciones">Colecciones</a>
            <a href="#productos">Productos</a>
            <a href="#faq">Preguntas frecuentes</a>
            <a href="#contacto">Contacto</a>
          </div>
        </div>
        <div>
          <h4>Ubicaci√≥n y horario (demo)</h4>
          <div>Calle 23 Num 81B Int 2, Cholul, 97300, Yuc.</div>
          <div>Lun‚ÄìVie 08:30‚Äì17:30 ‚Ä¢ S√°b 08:30‚Äì12:30</div>
          <div style="margin-top:8px;">WhatsApp: 999 121 4058</div>
        </div>
      </div>

      <div class="copy">
        ¬© <span id="year"></span> ‚Äî P√°gina de simulaci√≥n para laboratorio. No afiliada.
      </div>
    </div>
  </footer>

  <!-- ===== MODAL CHAT (Atenci√≥n al cliente) ===== -->
  <div id="supportModal" class="modal" aria-hidden="true">
    <div class="modal__backdrop" data-close="1"></div>

    <div class="modal__panel" role="dialog" aria-modal="true" aria-label="Atenci√≥n al cliente">
      <div class="modal__head">
        <div>
          <b>Atenci√≥n al cliente</b>
          <div class="modal__sub">Chat conectado a n8n</div>
        </div>
        <button class="btn" id="btnCloseSupport" type="button" aria-label="Cerrar">‚úï</button>
      </div>

      <div id="kai-log" class="chatlog" aria-live="polite"></div>

      <form id="kai-form" class="chatbar">
        <input id="kai-msg" class="field" placeholder="Escribe aqu√≠‚Ä¶" autocomplete="off" />
        <button class="btn primary" type="submit">Enviar</button>
      </form>
    </div>
  </div>
  <!-- ===== /MODAL CHAT ===== -->

  <script>
    // ====== Datos demo (sustituye por tu JSON/CSV) ======
    const DEMO_PRODUCTS = [
      { id:"P-001", title:"Toalla interdoblada universal (demo)", collection:"Papel", price:383.30, stock:"out", tag:"Papel" },
      { id:"P-002", title:"Higi√©nico bobina mini (demo)", collection:"Papel", price:597.31, stock:"in", tag:"Papel" },
      { id:"L-001", title:"Limpiador multiusos concentrado (demo)", collection:"Limpieza", price:68.90, stock:"in", tag:"Limpieza" },
      { id:"L-002", title:"Desinfectante para superficies (demo)", collection:"Limpieza", price:92.50, stock:"in", tag:"Desinfecci√≥n" },
      { id:"A-001", title:"Aroma aerosol 400 ml (demo)", collection:"Aromatizantes", price:26.67, stock:"out", tag:"Aerosol" },
      { id:"A-002", title:"Aromatizante 1 L (demo)", collection:"Aromatizantes", price:13.03, stock:"in", tag:"Aromas" },
      { id:"J-001", title:"Mopa industrial con bast√≥n (demo)", collection:"Jarcier√≠a", price:145.00, stock:"in", tag:"Jarcier√≠a" },
      { id:"J-002", title:"Jalador para pisos (demo)", collection:"Jarcier√≠a", price:89.00, stock:"in", tag:"Operaci√≥n" },
      { id:"AU-001", title:"Abrillantador de llantas en gel (demo)", collection:"Autos", price:37.33, stock:"in", tag:"Autos" },
      { id:"AU-002", title:"Shampoo automotriz (demo)", collection:"Autos", price:59.90, stock:"in", tag:"Autos" },
      { id:"L-003", title:"Detergente l√≠quido (demo)", collection:"Limpieza", price:54.20, stock:"in", tag:"Detergente" },
      { id:"P-003", title:"Servilleta dispensador (demo)", collection:"Papel", price:391.88, stock:"in", tag:"Servilletas" },
    ];

    const elProducts = document.getElementById("products");
    const elQ = document.getElementById("q");
    const elCollection = document.getElementById("filterCollection");
    const elStock = document.getElementById("filterStock");
    const elSort = document.getElementById("sortBy");
    const elReset = document.getElementById("btnReset");

    function money(n){
      try {
        return new Intl.NumberFormat("es-MX",{ style:"currency", currency:"MXN" }).format(n);
      } catch {
        return "$ " + Number(n).toFixed(2);
      }
    }

    function render(products){
      elProducts.innerHTML = "";
      if(!products.length){
        elProducts.innerHTML = `<div class="tile" style="grid-column:1 / -1;">
          <h3>Sin resultados</h3>
          <p>Prueba otro t√©rmino o cambia filtros.</p>
        </div>`;
        return;
      }
      for(const p of products){
        const node = document.createElement("article");
        node.className = "product";
        node.setAttribute("data-collection", p.collection);
        node.setAttribute("data-stock", p.stock);
        node.setAttribute("data-price", String(p.price));
        node.setAttribute("data-title", p.title.toLowerCase());

        node.innerHTML = `
          <div class="thumb">
            <div class="tag">${p.tag}${p.stock === "out" ? " ‚Ä¢ Agotado" : ""}</div>
          </div>
          <div class="pBody">
            <p class="pTitle"><b>${p.title}</b></p>
            <p class="pDesc">SKU: ${p.id} ‚Ä¢ Colecci√≥n: ${p.collection}</p>
            <div class="pRow">
              <span class="price">${money(p.price)}</span>
              <button class="btn" type="button" data-add="${p.id}">
                ${p.stock === "out" ? "Avisar" : "Agregar"}
              </button>
            </div>
          </div>
        `;
        elProducts.appendChild(node);
      }
    }

    function applyFilters(){
      const q = (elQ.value || "").trim().toLowerCase();
      const c = elCollection.value;
      const s = elStock.value;

      let list = DEMO_PRODUCTS.slice();

      if(c !== "all") list = list.filter(p => p.collection === c);
      if(s !== "all") list = list.filter(p => p.stock === (s === "in" ? "in" : "out"));
      if(q) list = list.filter(p =>
        p.title.toLowerCase().includes(q) ||
        p.id.toLowerCase().includes(q) ||
        p.collection.toLowerCase().includes(q)
      );

      const sort = elSort.value;
      if(sort === "az") list.sort((a,b)=> a.title.localeCompare(b.title));
      if(sort === "za") list.sort((a,b)=> b.title.localeCompare(a.title));
      if(sort === "priceAsc") list.sort((a,b)=> a.price - b.price);
      if(sort === "priceDesc") list.sort((a,b)=> b.price - a.price);

      render(list);
    }

    document.querySelectorAll("[data-collection]").forEach(a=>{
      a.addEventListener("click", ()=>{
        const c = a.getAttribute("data-collection");
        if(c){ elCollection.value = c; applyFilters(); }
      });
    });

    ["input","change"].forEach(evt=>{
      elQ.addEventListener(evt, applyFilters);
      elCollection.addEventListener(evt, applyFilters);
      elStock.addEventListener(evt, applyFilters);
      elSort.addEventListener(evt, applyFilters);
    });

    elReset.addEventListener("click", ()=>{
      elQ.value = "";
      elCollection.value = "all";
      elStock.value = "all";
      elSort.value = "popular";
      applyFilters();
    });

    document.addEventListener("click", (e)=>{
      const btn = e.target.closest("[data-add]");
      if(btn){
        const sku = btn.getAttribute("data-add");
        alert("Simulaci√≥n: acci√≥n de carrito / avisos. SKU: " + sku);
      }
    });
    document.getElementById("btnCart").addEventListener("click", ()=>{
      alert("Carrito simulado (laboratorio). Conecta esto a tu flujo n8n/CRM si quieres.");
    });

    // Contact form (simulado)
    const contactFormEl = document.getElementById("contactForm");
    const formStatusEl = document.getElementById("formStatus");
    contactFormEl.addEventListener("submit", (e)=>{
      e.preventDefault();
      const data = Object.fromEntries(new FormData(contactFormEl).entries());
      console.log("Lead (demo):", data);
      formStatusEl.textContent = "Enviado (simulaci√≥n). Revisa la consola.";
      contactFormEl.reset();
      setTimeout(()=> formStatusEl.textContent = "", 4000);
    });

    document.getElementById("year").textContent = new Date().getFullYear();
    applyFilters();

    // ====== CHAT SOPORTE (n8n REAL) ======
    const WEBHOOK_URL = "https://kukulcanai.app.n8n.cloud/webhook/4d3ac12e-06bf-4f5f-8bcd-c3b4e0b74008/chat";

    const supportModal = document.getElementById("supportModal");
    const btnSupport = document.getElementById("btnSupport");
    const btnCloseSupport = document.getElementById("btnCloseSupport");

    const chatLog = document.getElementById("kai-log");
    const supportForm = document.getElementById("kai-form");
    const chatMsg = document.getElementById("kai-msg");

    const supportSessionId =
      localStorage.getItem("kai_support_sessionId") ||
      (crypto.randomUUID ? crypto.randomUUID() : String(Date.now()));
    localStorage.setItem("kai_support_sessionId", supportSessionId);

    function timeHHMM(){
      const d = new Date();
      return d.toLocaleTimeString([], { hour:"2-digit", minute:"2-digit" });
    }

    function addChatBubble(who, text){
      const div = document.createElement("div");
      div.className = "msg " + (who === "me" ? "me" : "bot");
      div.textContent = text;
      const meta = document.createElement("span");
      meta.className = "meta";
      meta.textContent = (who === "me" ? "T√∫" : "Bot") + " ‚Ä¢ " + timeHHMM();
      div.appendChild(meta);
      chatLog.appendChild(div);
      chatLog.scrollTop = chatLog.scrollHeight;
    }

    function openSupport(){
      supportModal.classList.add("is-open");
      supportModal.setAttribute("aria-hidden","false");
      if (!chatLog.hasChildNodes()){
        addChatBubble("bot", "Hola üëã Soy el chat conectado a n8n. ¬øEn qu√© te ayudo?");
      }
      setTimeout(()=> chatMsg.focus(), 50);
    }
    function closeSupport(){
      supportModal.classList.remove("is-open");
      supportModal.setAttribute("aria-hidden","true");
    }

    btnSupport.addEventListener("click", openSupport);
    btnCloseSupport.addEventListener("click", closeSupport);
    supportModal.addEventListener("click", (e)=>{
      if (e.target && e.target.getAttribute("data-close") === "1") closeSupport();
    });
    document.addEventListener("keydown", (e)=>{
      if (e.key === "Escape" && supportModal.classList.contains("is-open")) closeSupport();
    });

    async function sendToN8n(message){
      const r = await fetch(WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          message,
          sessionId: supportSessionId,
          source: "web",
          ts: new Date().toISOString()
        })
      });

      // Si n8n devuelve HTML o texto plano, intenta igualmente
      const contentType = (r.headers.get("content-type") || "").toLowerCase();
      let data = null;

      if(contentType.includes("application/json")){
        data = await r.json();
      } else {
        const txt = await r.text();
        data = { reply: txt };
      }

      if (!r.ok){
        const msg = (data && (data.error || data.message || data.reply)) ? (data.error || data.message || data.reply) : ("HTTP " + r.status);
        throw new Error(msg);
      }

      return data;
    }

    function pickReply(data){
      if(!data) return "(sin respuesta)";
      if(typeof data === "string") return data;

      // campos t√≠picos
      const candidates = [
        data.reply,
        data.text,
        data.message,
        data.output,
        data.answer,
        data.response,
        data.data?.reply,
        data.data?.text
      ].filter(Boolean);

      if(candidates.length) return String(candidates[0]);

      // si viene como array tipo [{...}]
      if(Array.isArray(data) && data.length){
        const d0 = data[0];
        return String(d0.reply || d0.text || d0.message || JSON.stringify(d0));
      }

      return JSON.stringify(data);
    }

    supportForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const message = (chatMsg.value || "").trim();
      if (!message) return;

      chatMsg.value = "";
      addChatBubble("me", message);

      try {
        const data = await sendToN8n(message);
        addChatBubble("bot", pickReply(data));
      } catch (err) {
        console.error(err);
        addChatBubble("bot", "‚ùå Error conectando con n8n. Revisa: workflow activo, CORS (si aplica) y que el webhook responda JSON.");
      }
    });
  </script>
</body>
</html>
